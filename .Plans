# RedactedCraft Plans (Easiest → Hardest)

This file is the authoritative list of planned features and improvements.
When implementing, do ONE feature per prompt unless explicitly bundling small related items.
Always: Plan → minimal diff → test instructions.

---

## 0) Current Baseline (Already Exists)
- WinForms launcher with live logs, profile, settings, asset installer
- Single-exe model: launcher mode vs --game mode
- LAN multiplayer:
  - UDP discovery
  - TCP session with length-prefixed messages (player state, block set)

---

## 1) EASIEST (Quick Wins / Low Risk)

### 1.1 Launcher: Play Offline Mode
- Add "PLAY OFFLINE" button in launcher.
- Launch game with `--offline`.
- Multiplayer UI disabled/greyed out when offline.
- In-game: clicking multiplayer while offline shows "Offline mode" message.

### 1.2 Launcher: World Backup / Restore
- One-click backup: zip:
  - Documents\RedactedCraft\Worlds\
  - Documents\RedactedCraft\Worlds_Multiplayer\ (if used)
  - optional settings.json + player_profile.json
- Save zips to Documents\RedactedCraft\Backups\backup-YYYYMMDD-HHMM.zip
- Retention: keep last N backups (default 10).
- Optional config: custom backup location (e.g., OneDrive/Google Drive synced folder).

### 1.3 Launcher: Version/Protocol Display + Mismatch Warning
- Display game version + protocol version.
- Warn/block online join when mismatch is detected.

### 1.4 Launcher: Network Diagnostics Tab
- Show:
  - Hub reachable status (HTTP ping)
  - Ports expected open
  - Local IP(s) + public IP
- Optional: simple connect tests to hub endpoints.

### 1.5 Launcher: Safe Mode Launch
- If last run crashed, offer “Launch Safe Mode”:
  - low graphics, conservative settings
  - disable optional packs
- Always include "Open Logs" shortcut.

---

## 2) MEDIUM (Moderate Complexity / High Value)

### 2.1 Launcher: Live GitHub Changelog Tab
- Pull Markdown + images from a GitHub raw URL (configurable).
- Cache locally in Documents\RedactedCraft\cache\changelog.md
- Auto-refresh every 10 minutes + manual refresh.
- Render nicely (prefer WebView2; fallback to raw markdown if unavailable).

### 2.2 Movement: Fix Fly Mode (Collision + Sway)
- Fly mode should NOT be noclip.
- Keep collision while flying (player cannot pass through blocks).
- Optional: subtle flight sway/bob using lightweight animation/physics-like smoothing.

### 2.3 Persistence: Chunk Save/Load Improvements
- Chunk-per-file storage.
- Dirty flags: save only modified chunks.
- Fast load/unload of chunk files.

### 2.4 Gameplay: Inventory + Hotbar + Block Picking
- Basic hotbar UI.
- Select blocks.
- Middle-click (or key) block picking.

### 2.5 Gameplay: Basic Interactables
- Doors: open/close toggle.
- Chest: placeholder UI + storage later.
- Crafting table: placeholder UI.

### 2.6 Worldgen: Layered Terrain
- Dirt/stone layers.
- Ores.
- Trees (procedural or prefab placement).

---

## 3) HARD (Engine-Level / Multi-System)

### 3.1 Voxel Rendering: Greedy Meshing
- Replace naive face meshing with greedy meshing per chunk.
- Reduce triangles + draw cost.
- Keep chunk rebuild stable.

### 3.2 Voxel Rendering: Ambient Occlusion in Meshing
- Add AO per-vertex based on neighbor occupancy.
- Minimal cost, big visual upgrade.

### 3.3 Engine: Chunk Streaming + Prioritized Meshing + Background Workers
- Prioritize chunk rebuild by distance.
- Time-slice work per frame.
- Background worker threads for chunk generation + mesh building.
- Main thread uploads mesh buffers to GPU.

### 3.4 Graphics: Advanced Lighting + Shader System
- Add advanced lighting/shaders (forward lighting, shadows, post-processing).
- Plan for player shader packs:
  - load custom effects/shaders from a designated folder
  - safe fallback to defaults
  - version compatibility rules

---

## 4) ONLINE SYSTEM (Internet Playable, No IP Exposure)

### 4.1 FriendsHub (2nd PC) - Directory + Relay (NO Game Simulation)
Goal:
- Internet playable online play while hiding player IPs.
- FriendsHub is the only server component.

FriendsHub features:
- Accounts: register/login with UNIQUE usernames (case-insensitive)
- Secure password hashing (PBKDF2)
- Friends: request/accept/remove
- Presence: heartbeat every ~10 seconds
- Invites: join tokens, expiry, accept flow
- Relay: TCP relay for gameplay packets so peers never see each other’s IP

Ports (recommended):
- TCP 443 (preferred) or TCP 8080 fallback: directory API
- TCP 27038: relay port
- UDP 3478 is OPTIONAL for future STUN (not required for relay-only)

Deployment:
- FriendsHub runs as single self-contained EXE with small GUI + live logs.
- Must run on fresh Windows 11 without installing extra runtimes (self-contained publish).
- Provide README_HUB.md with port forwarding and firewall steps.

Client integration (in-game Profile):
- Login/register/forgot password UI in Profile screen.
- Hub session cached in `hub_auth.json` and restored on game start.
- Friends list shows pending/accepted + online; relay-hosted friends expose world name + Join button.
- Launcher stays offline-focused (no hub UI).

---

## 5) FUTURE (After Hub Stable)

### 5.1 Launcher Social Tab (Polling Chat)
- Friends list + online status.
- DMs first, groups later.
- Polling every 1–2 seconds (backoff when idle).
- Store messages in SQLite on the hub (offline catch-up).

### 5.2 Networking Upgrade (Optional): LiteNetLib
- Consider migrating gameplay networking to reliable UDP for smoother movement.
- Only after stable relay + protocol versioning.

---

## Implementation Rules (for Codex/Windsurf)
- Implement one feature per prompt unless bundling tightly related small items.
- Do not refactor unrelated code.
- Always:
  1) list the exact files to change/add
  2) implement
  3) summarize changes + how to test
- Preserve LAN mode and existing launcher/game flow.
